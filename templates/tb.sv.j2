
module {{ tb['name'] }}_tb;

  import uvm_pkg::*;
  `include "uvm_macros.svh"

  import {{ tb['name'] }}_env_pkg::*;
  import {{ tb['name'] }}_test_pkg::*;

  // reset, clock
  logic  rst_n;
  logic  clk;
 
  initial begin : rst_block
    rst_n = 1;
    // assert reset syncronously
    repeat(2) @(posedge clk);
    rst_n = 0;
    // release reset syncronously
    repeat(10) @(posedge clk);
    rst_n = 1;
   end : rst_block

  initial begin : clk_block
    clk   = 0;
    // Clk - 1GHz
    forever #500ps clk = ~clk;
  end : clk_block

  // UVM Test run
  initial begin
    run_test();
  end

  // DUT instance
  // FIXME: here

  {% for agent in tb['agents'] %}
  // {{ agent['name'] }} interfaces
  {{ agent['name'] }}_if {{ agent['instance_name'] }}_if_i (clk, rst_n);
  initial begin
    // Setting config of those agents
    uvm_config_db #( virtual {{ agent['name'] }}_if )::set(
      null, "*.m_{{ agent['instance_name'] }}_agent_h*", 
      "{{ agent['name'] }}_vif", {{ agent['instance_name'] }}_if_i );
  end
  {% endfor %}

endmodule : {{ tb['name'] }}_tb